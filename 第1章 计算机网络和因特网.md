# 第1章 计算机网络和因特网



## 1.1什么是因特网

1.与因特网连接的计算机和其他设备称为<font color = #FF0000>主机</font>或<font color = #FF0000>端系统</font>。端系统通过<font color = #FF0000>通信链路</font>和<font color = #FF0000>分组交换机</font>连接到一起。链路的传输速率以比特/秒度量。

2.当一台端系统要向另一台端系统发送数据时，发送端系统将数据分段，并为每段加上首部字节。由此形成的信息包用计算机网络的术语来说成为<font color = #FF0000>分组</font>。这些分组通过网络发送到目的端系统，在哪里被装配成初始数据。

3.<font color = #FF0000>分组交换机</font>从它的一条入通信链路接收到达的分组，并从它的一条出通信链路转发该分组。在当今的因特网中，两种最著名的分组交换机的类型是<font color = #FF0000>路由器</font>和<font color = #FF0000>链路层交换机</font>。

4.端系统通过<font color = #FF0000>因特网服务提供商</font>（Internet Service Provider, <font color = #FF0000>ISP</font>）接入因特网。每个ISP自身就是一个由多台分组交换机和多段通信链路组成的网络。较低层的ISP通过国家的、国际的较高层ISP互联起来。较高层ISP是通过高速光纤链路互联的高速路由器组成的。

5.端系统、分组交换机和其他因特网部件都要运行一系列的<font color = #FF0000>协议</font>，这些协议控制因特网中信息的接收和发送。<font color = #FF0000>TCP</font>和<font color = #FF0000>IP</font>是因特网中两个最为重要的协议。

6.涉及多个相互交换数据的端系统的应用程序成为<font color = #FF0000>分布式应用程序</font>。

7.与因特网相连的端系统提供了一个<font color = #FF0000>套接字接口</font>，该结构规定了运行在一个端系统上的程序请求因特网基础设施向运行在另一个端系统上的特定目的地程序交付数据的方式。

8.<font color = #FF0000>协议</font>定义了在两个或多个通信实体之间交换的报文的格式和顺序，以及报文发送和/或接收一条报文或其他事件所采取的动作。



## 1.2网络边缘

1.主机或端系统被划分为两类：<font color = #FF0000>客户</font>和<font color = #FF0000>服务器</font>。客户通常是桌面PC、移动PC和智能手机等，而服务器通常是更为强大的机器。今天，大部分提供搜索结果、电子邮件、Web页面和视频的服务器都属于大型<font color = #FF0000>数据中心</font>。

2.<font color = #FF0000>接入网</font>是指将端系统物理连接到其边缘路由器的网络。<font color = #FF0000>边缘路由器</font>是端系统到任何其他远程端系统的路径上的第一台路由器。

3.家庭接入网有如下的类型：

​       <font color = #FF0000>数字用户线</font>（Digital Subscriber Line, <font color = #FF0000>DSL</font>）。住户通常从提供本地电话接入的本地电话公司处获得DSL因特网接入。因此，当使用DSL时，用户的本地电话公司也是它的ISP。DSL标准定义了多个传输速率，包括12Mbps下行和1.8Mbps上行传输速率，以及55Mbps下行和15Mbps上行传输速率。因为这些上行速率和下行速率是不同的，所以这种接入被称为是<font color = #FF0000>不对称的</font>。实际取得的下行和上行传输速率也许小于上述速率，因为当DSL提供商提供分等级的服务时，他们也许有意地限制了住宅速率，或者因为家庭与本地中心局之间的距离、双绞线的规格和电气干扰的程度而使最大速率受限。

​       <font color = #FF0000>电缆因特网接入</font>。电缆因特网接入利用了有线电视公司现有的优先电视基础设施。住宅从提供优先电视的公司获得了电缆因特网接入。在这个系统中应用了光纤和同轴电缆，所以它经常被称为<font color = #FF0000>混合光纤同轴</font>（Hybird Fiber Coax, <font color = #FF0000>HFC</font>）系统。电缆因特网接入需要特殊的调制解调器，这种调制解调器称为<font color = #FF0000>电缆调制解调器</font>。电缆因特网接入的一个重要特征是<font color = #FF0000>共享广播媒体</font>。特别是，由头端发送的每个分组向下行经每段链路到每个家庭；每个家庭发送的每个分组经上行信道向头端传输。因此，如果几个用户同时经下行信道下载一个视频文件，每个用户接收视频文件的实际速率将大大低于电缆总计的下行速率。相反，如果仅有很少的活跃用户在进行Web冲浪，则每个用户都可以以全部的下行速率接收Web网页。

​       <font color = #FF0000>光纤到户</font>（Fiber To The Home, <font color = #FF0000>FTTH</font>）。FTTH即从本地中心局到每户设置一根光纤。更为一般的是，从中心局出来的每根光纤实际上有许多家庭共享，直到相对接近这些家庭的位置，该光纤才分成每户一根光纤。进行这种分配有两种有竞争性的光纤分布体系结构：<font color = #FF0000>主动光纤网络</font>（Active Optical Network, <font color = #FF0000>AON</font>）和<font color = #FF0000>被动光纤网络</font>（Passive Optical Network, <font color = #FF0000>PON</font>）。

4.企业（和家庭）接入网类型有以太网和WiFi。广域无线网接入网类型有3G和LTE（Long-Term Evolution）。

5.发射和接收比特时，对于每个发射器-接收器对，通过跨越一种<font color = #FF0000>物理媒体</font>传播电磁波或光脉冲来发送该比特。物理媒体包括双绞铜线、同轴电缆、多模光纤缆、陆地无线电频谱和微星无线电频谱。物理媒体分成两种类型：<font color = #FF0000>导引型媒体</font>和<font color = #FF0000>非导引型媒体</font>。对于导引型媒体，电波沿着固体媒体前行，如光缆、双绞铜线或同轴电缆。对于非导引型媒体，电波在空气或外层空间中传播，例如在无限局域网或数字卫星频道中。



## 1.3网络核心

1.通过网络链路与交换机移动数据有两种基本方法：<font color = #FF0000>分组交换</font>和<font color = #FF0000>电路交换</font>。

2.在各种网络应用中，端系统彼此交换<font color = #FF0000>报文</font>。为了从源端系统发送一个报文，源将长报文划分为较小的数据块，称之为<font color = #FF0000>分组</font>。在源和目的地之间，每个分组都通过通信链路和分组交换机传送。

3.多数分组交换机在链路的输入端使用<font color = #FF0000>存储转发机制</font>。存储转发机制是指在交换机能够开始向输出链路传输该分组的第一个比特之前，必须接收到整个分组。

4.通过由N条速率均为R的链路组成的路径，从源到目的地发送一个分组的端到端时延为
$$
d = N  \frac{L}{R}
$$
5.每台分组交换机有多条链路与之相连。对于每条相连的链路，该分组交换机具有一个<font color = #FF0000>输出缓存</font>（output buffer，也成为输出队列（output quque）），它用于存储路由器准备发往的那条链路的分组。该输出缓存在分组交换中起着重要的作用。如果到达的分组需要传输到某条链路，但发现该链路正忙于传输其他分组，该到达分组必须在输出缓存中等待。因此，除了存储转发时延以外，分组还要承受输出缓存的<font color = #FF0000>排队时延</font>。这些时延是变化的，变化的程度取决于网络的拥塞程度。因为缓存空间的大小是优先的，一个到达的分组可能发现该缓存已被其他等待传输的分组完全充满了。在此情况下，将出现<font color = #FF0000>分组丢失</font>（<font color = #FF0000>丢包</font>），到达的分组或已经排队的分组之一将被丢弃。

6.在因特网中，每个端系统具有一个称为IP地址的地址。当源主机要想目的端系统发送一个分组时，源在该分组的首部包含了目的地的IP地址。该地址具有一种等级结构。当一个分组到达网络中的路由器时，路由器检查该分组的目的地地址的一部分，并向一台相邻路由器转发该分组。每台路由器具有一个<font color = #FF0000>转发表</font>，用于将目的地址（或目的地址的一部分）映射成为输出链路。因特网具有一些特殊的路由选择协议，用于自动地设置这些转发表。

7.在电路交换网络中，在端系统间通信会话期间，预留了端系统间沿路径通信所需要的资源。在分组交换网络中，这些资源则不是预留的，会话的报文按需使用这些资源，其后果是不得不等待接入通信线路。

8.电路交换中有两种复用，分别为<font color = #FF0000>频分复用</font>（Frequency-Division Multiplexing, <font color = #FF0000>FDM</font>）和<font color = #FF0000>时分复用</font>（Time-Division Multiplexing, <font color = #FF0000>TDM</font>）。对于FDM，链路的频谱有跨越链路创建的所有连接共享。在连接期间链路为每条连接专用一个频段。对于一条TDM链路，时间被划分为固定期间的帧，并且每个帧又被划分为固定数量的时隙。对于TDM，一条电路的传输速率等于帧速率乘以一个时隙中的比特数量。

9.分组交换提供了比电路交换更好的带宽共享，它比电路交换更简单、更有效，实现成本更低。所以，虽然分组交换和电路交换在今天的电信网络中都是普遍采用的方式，但趋势无疑是朝着分组交换的方向发展。

10.<font color = #FF0000>存在点</font>（Point of Presence, <font color = #FF0000>PoP</font>）存在与因特网等级结构的所有层次，但底层（接入ISP）等级除外。一个PoP只是提供商网络中的一台或多台路由器（在相同位置）群组，其中客户ISP能够与提供商ISP连接。对于要与提供商PoP连接的客户网络，它能从第三方电信提供商租用高速链路将它的路由器之一直接连接到位于该PoP的一台路由器。任何ISP可以选择<font color = #FF0000>多宿</font>，即可以与两个或更多提供商ISP连接。

11.客户ISP向它们的提供商ISP付费以获得全球因特网互联能力。客户ISP支付给提供商ISP的费用数额反应了它通过提供商交换的通信流量。为了减少这些费用，位于相同等级结构层次的邻近一对ISP能够<font color = #FF0000>对等</font>，也就是说，能够直接将它们的网络连到一起，使它们之间的所有流量经直接连接而不是通过上游的中间ISP传输。当两个ISP对等时，通常不进行结算，即任一个ISP不向其对等付费。第三方公司能够创建一个因特网交换点（Internet Exchange Point, IXP），IXP是一个汇合点，多个ISP能够在这里一起对等。IXP通常位于一个有自己的交换机的独立建筑物中。



## 1.4分组交换网中的时延、丢包和吞吐量

1.当分组从一个节点沿着这条路径到后继节点，该分组在沿途的每个节点经受了几种不同类型的时延。这些时延最为重要的是<font color = #FF0000>节点处理时延、排队时延、传输时延和传播时延，这些时延总体累加起来时节点总时延</font>。

2.处理时延。检查分组首部和决定将该分组导向何处所需要的时间是处理时延的一部分。处理时延也能够包括其他因素。

3.排队时延。在队列中，当分组在链路上等待传输时，它经受排队时延。

4.传输时延。用L表示分组的长度，用R表示从路由器A到路由器B的链路传输速率。则传输时延就是L/R。这是将所有分组的比特推向链路所需要的时间。

5.一旦一个比特被推向链路，该比特需要向路由器B传播。从该链路的起点到路由器B传播所需要的时间是传播时延。

6.令dproc、dqueue、dtrans和dprop分别表示处理时延、排队时延、传输时延和传播时延，则节点的总时延由下式决定
$$
d_{nodal} = d_{proc} + d_{queue} + d_{trans} + d_{prop}
$$
7.令a表示分组到达队列的平均速率，R表示传输速率，假定所有分组都是由L比特组成的。则比特达到队列的平均速率是La bps。假定队列非常大，能容纳无限数量的比特。比率La/R被称为<font color = #FF0000>流量强度</font>，它在估计牌堆时延的范围方面经常起着重要的作用。如果La/R > 1，则比特到达队列的平均速率超过从该队列传输出去的速率。在这种情况下，该队列去向与无线增加，并且排队时延将趋向无穷大。因此，设计系统时流量强度不能大于1。

8.端到端时延
$$
d_{end-end} = N(d_{proc} + d_{trans} + d_{prop})
$$
9.考虑从主机A到主机B跨越计算机网络传送一个大文件。在任何时间瞬间的<font color = #FF0000>瞬时吞吐量</font>是主机B接收到该文件的速率。如果该文件由F比特组成，主机B接收到所有F比特用去T秒，则文件传送的<font color = #FF0000>平均吞吐量</font>是F/T bps。吞吐量取决于沿着源和目的地之间路径的最小传输速率。



## 1.5协议层次及其服务模型

1.网络设计者以<font color = #FF0000>分层</font>的方式组织协议以及实现协议的网络硬件和软件。每层通过在该层中执行某些动作或使用直接下层的服务来提供服务。各层的协议被称为<font color = #FF0000>协议栈</font>。因特网的协议栈由5个层次组成：<font color = #FF0000>物理层、链路层、网络层、运输层和应用层</font>。

2.应用层是网络应用程序及它们的应用层协议存留的地方。位于应用层的信息分组称为<font color = #FF0000>报文</font>。

3.运输层在应用程序端点之间传送应用层报文。运输层的分组称为<font color = #FF0000>报文段</font>。

4.网络层负责将称为<font color = #FF0000>数据报</font>的网络层分组从一台主机移动到另一台主机。

5.为了将分组从一个节点移动到路径上的下一个节点，网络层必须依靠该链路层的服务。特别是在每个节点，网络层将数据报下穿给链路层，链路层沿着路径将数据报传递给下一个节点。在该下一个节点，链路层将数据报上传给网络层。链路层分组称为<font color = #FF0000>帧</font>。

6.物理层的任务是将该帧中的一个个比特从一个节点移动到下一个节点。

7.开放系统互联模型（OSI）有7个层次：应用层、表示层、会话层、运输层、网络层、数据链路层和物理层。其中5层的功能大致与它们名字类似的因特网对应层的功能相同。表示层的作用是使通信的应用程序能够解释交换数据的含义。会话层提供了数据交换的定界和同步功能，包括了建立检查点和恢复方案的方法。

8.与端系统类似，路由器和链路层交换机以多层次的方式组织他们的网络硬件和软件。而路由器和链路层交换机并不实现协议栈中的所有层次。链路层交换机实现了第一层和第二层；路由器实现了第一层到第三层。

9.在每一层，一个分组具有两种类型的字段：<font color = #FF0000>首部字段</font>和<font color = #FF0000>有效载荷字段</font>。有效载荷通常是来自上一层的分组。



## 1.6面对攻击的网络

1.<font color = #FF0000>病毒是</font>一种需要某种形式的用户交互来感染用户设备的恶意软件。

2.<font color = #FF0000>蠕虫</font>是一种无须任何明显用户交互就能进入设备的恶意软件。

3.<font color = #FF0000>拒绝服务攻击</font>（Denial-of-Service (<font color = #FF0000>Dos</font>) attack）使得网络、主机或其他基础设施部分不能由合法用户使用。大多数因特网DoS攻击属于下列三种类型之一：

​       <font color = #FF0000>弱点攻击</font>。这涉及想一台目标主机上运行的易受攻击的应用程序或操作系统发送制作精细的报文。如果适当顺序的多个分组发送给一个易受攻击的应用程序或操作系统，该服务器可能停止运行，或者更糟糕的是主机可能崩溃。

​       <font color = #FF0000>带宽洪泛</font>。攻击者向目标主机发送大量的分组，分组数量至多使得目标的接入链路变得拥塞，使得合法的分组无法到达服务器。

​       <font color = #FF0000>连接洪泛</font>。攻击者在目标主机中创建大量的半开或全开TCP连接。该主机因为这些伪造的连接而陷入困境，并停止接受合法的连接。

4.<font color = #FF0000>分布式DoS</font>（Distributed DoS, <font color = #FF0000>DDoS</font>）中，攻击者控制多个源并让每个源向目标猛烈发送流量。相比于来自单一主机的DoS攻击，DDoS攻击更加难以检测和防范。

5.记录每个流经的分组副本的被动接收机称为<font color = #FF0000>分组嗅探器</font>。

6.将具有虚假源地址的分组注入因特网的能力被称为<font color = #FF0000>IP哄骗</font>。

